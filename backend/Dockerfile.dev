FROM gradle:8.5-jdk17
WORKDIR /app

# Copy gradle files
COPY build.gradle settings.gradle gradle.properties ./

# Download dependencies (cached layer)
RUN gradle build --no-daemon -x test || true

# Copy source code
COPY . .

# Run the app
EXPOSE 8080
CMD ["gradle", "bootRun", "--no-daemon"]